# Sonnet-Generator

The sonnet is a type of poem that has been a part of the literary repertoire since the thirteenth century. 
Sonnets can communicate a sundry of details contained within a single thought, mood, or feeling, typically culminating in the last lines. 

## Model 
The model is character-based and does not learn the meaning or context of words. A sonnet like any poem is abstract and does not have clearly understandable meaning. For this reason, it is sufficient for the model to learn the sequences of characters alone. With a sequence of 100 characters, it is able to predict a much longer sequence of text with a proper structure. The model uses a type of Recurrent Neural Network(RNN) called a Gated Recurrent Unit(GRU) to remember relevant patterns in previous sequences, forget unnecessary details, and predict the next sequence. 

### Training

To train the model from scratch, a system with a GPU is required. It is recommended that the files be run on a service that provides GPU support such as Google Colab. To train the model on colab, use the following steps:

(Note: commands mentioned work mostly for OS X or linux OS)

` !git clone https://github.com/alt-nikitha/Sonnet-Generator.git ` 

` cd Sonnet-Generator ` 

` !pip install -r requirements.txt ` 

` !python pre.py dataset.txt dataset2.txt ` 

` !python train.py ` 

Even with a gpu, training can take quite a while, so wait until that's done.
The trained models will get stored in the training_checkpoints folder. At this point, you can zip this folder and download it for future use as follows:


` !zip -r  training_checkpoints.zip  /training_checkpoints/ `

You can also save it to google drive. Mount your google drive:
    
``` 
from google.colab import drive
drive.mount('content/gdrive') 
```

Next copy the folder to your drive:

` cd .. `

` !cp -r /content/training_checkpoints /content/gdrive/My\ Drive `

` cd Sonnet-Generator ` 

### Testing
We have created a Flask application that provides a nice UI to generate sonnets when a user enters a starting prompt. The application uses the trained model in the backend.
We can run this on a local system, so you can head over to the command prompt after you've cloned and changed directory locally. You can also deploy it with a public URL which we have chosen to do using google colab,and we will get to that in a bit. <br>
On your local system, you can replace the contents of the training_checkpoints folder with your own trained model from the previous training steps or work with the weights we've already saved.

First, create a virtual environment:

`python -m venv name_of_virtualenv`

Replace the name_of_virtualenv with a name of your choice.
Next, activate the virtual environment.

` source name_of_virtualenv/bin/activate `

Finally run this command to run the server for the flask application on your system

` !python app.py `

Once the server is running, enter the local host address that appears on the console into your browser window. <br>
The address will look like this: http://127.0.0.1:5000/
The flask app is now up and running locally, where you can enter a starting phrase to generate sonnets.
    
### Deploying

A public URL can be generated by running the same thing on google colab with a few changes to the ` app.py ` file

First, install ngrok library by running

` !pip install flask-ngrok`

ngrok is a lightweight tool used to generate public URLs for testing your model.

Second, make sure in your app.py file, the function app.run(), does not have debug set to True.

Third, in your app.py file, import this:-

`from flask_ngrok import run_with_ngrok`

Fourth, in your app.py file, 
type in this command:- 

`run_with_ngrok(app)` right below this 

`app = Flask(__name__,static_url_path='/static')`(Save all these changes in app.py)

Finally, run app.py

`!python app.py`

Click on the url that appears to see the app that's running.


